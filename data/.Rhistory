p2
# add a regression line
p3 <- p2 + geom_smooth(method = "lm")
# add a main title and draw the plot
p4 <- p3 + ggtitle("Student's attitude versus exam points")
p4
library(ggplot2)
# initialize plot with data and aesthetic mapping
p1 <- ggplot(analysis_dataset, aes(x = attitude, y = points, col = gender))
# define the visualization type (points)
p2 <- p1 + geom_point()
# draw the plot
p2
# add a regression line
p3 <- p2 + geom_smooth(method = "lm")
# add a main title and draw the plot
p4 <- p3 + ggtitle("Student's attitude versus exam points")
p4
library(ggplot2)
# initialize plot with data and aesthetic mapping
p1 <- ggplot(analysis_dataset, aes(x = attitude, y = points, col = gender))
# define the visualization type (points)
p2 <- p1 + geom_point()
# draw the plot
p2
# add a regression line
p3 <- p2 + geom_smooth(method = "lm")
# add a main title and draw the plot
p4 <- p3 + ggtitle("Student's attitude versus exam points (r=0.437")
p4
library(ggplot2)
# initialize plot with data and aesthetic mapping
p1 <- ggplot(analysis_dataset, aes(x = attitude, y = points, col = gender))
# define the visualization type (points)
p2 <- p1 + geom_point()
# draw the plot
p2
# add a regression line
p3 <- p2 + geom_smooth(method = "lm")
# add a main title and draw the plot
p4 <- p3 + ggtitle("Student's attitude versus exam points (r=0.437)")
p4
my_model2 <- lm(points ~ attitude + stra, data = learning2014)
my_model2 <- lm(points ~ attitude + stra, data = analysis_dataset)
par(mfrow = c(2,2))
plot(my_model2, which = c(1:2, 5))
library(ggplot2)
# create a regression model with multiple explanatory variables
my_model2 <- lm(attitude ~ surf, data = a)
# draw diagnostic plots using the plot() function. Choose the plots 1, 2 and 5
par(mfrow = c(2,2))
plot(my_model2, which = c(1:2, 5))
library(ggplot2)
# create a regression model with multiple explanatory variables
my_model2 <- lm(attitude ~ surf, data = analysis_dataset)
# draw diagnostic plots using the plot() function. Choose the plots 1, 2 and 5
par(mfrow = c(2,2))
plot(my_model2, which = c(1:2, 5))
# a scatter plot of points versus attitude
library(ggplot2)
qplot(attitude, points, data = analysis_dataset) + geom_smooth(method = "lm")
# fit a linear model
my_model <- lm(points ~ attitude, data = analysis_dataset)
# print out a summary of the model
summary(my_model)
# a scatter plot of points versus attitude
library(ggplot2)
qplot(attitude, surf, data = analysis_dataset) + geom_smooth(method = "lm")
# fit a linear model
my_model <- lm(surf ~ attitude, data = analysis_dataset)
# print out a summary of the model
summary(my_model)
# a scatter plot of points versus attitude
library(ggplot2)
qplot(attitude, deep, data = analysis_dataset) + geom_smooth(method = "lm")
# fit a linear model
my_model <- lm(deep ~ attitude, data = analysis_dataset)
# print out a summary of the model
summary(my_model)
# a scatter plot of points versus attitude
library(ggplot2)
qplot(attitude, surf, data = analysis_dataset) + geom_smooth(method = "lm")
# fit a linear model
my_model <- lm(surf ~ attitude, data = analysis_dataset)
# print out a summary of the model
summary(my_model)
# Sampsa Huttunen, 26.1.2017, Wrangling Data from 'JYTOPKYS3_data' to 'analysis_dataset'
# Access the dplyr library
library(dplyr)
# reading data from a file
JYTOPKYS3_data <- read.table("http://www.helsinki.fi/~kvehkala/JYTmooc/JYTOPKYS3-data.txt", sep = "\t", header = TRUE)
# viewing JYTOPKYS3_data: a dataset containing information of 183 individuals
View(JYTOPKYS3_data)
# inspecting JYTOPKYS3_data
dim(JYTOPKYS3_data)
# inspecting JYTOPKYS3_data
str(JYTOPKYS3_data)
# inspecting JYTOPKYS3_data
summary(JYTOPKYS3_data)
# Changing name of Age to age
colnames(JYTOPKYS3_data)[57] <- "age"
# Changing name of Attitude to attitude
colnames(JYTOPKYS3_data)[58] <- "attitude"
# Changing name of Points to points
colnames(JYTOPKYS3_data)[59] <- "points"
# print out the column names in data
colnames(JYTOPKYS3_data)
# choosing questions related to deep and surface learning, and learning strategies
deep_questions <- c("D03", "D11", "D19", "D27", "D07", "D14", "D22", "D30", "D06", "D15", "D23", "D31")
surface_questions <- c("SU02", "SU10", "SU18", "SU26", "SU05", "SU13", "SU21", "SU29", "SU08", "SU16", "SU24", "SU32")
strategic_questions <- c("ST01", "ST09", "ST17", "ST25", "ST04", "ST12", "ST20", "ST28")
# changing 'attitude' back to likert-scale (1-5)
JYTOPKYS3_data$attitude <- JYTOPKYS3_data$attitude/10
# select the columns related to deep learning and create column 'deep' by averaging
deep_columns <- select(JYTOPKYS3_data, one_of(deep_questions))
JYTOPKYS3_data$deep <- rowMeans(deep_columns)
# select the columns related to surface learning and create column 'surf' by averaging
surface_columns <- select(JYTOPKYS3_data, one_of(surface_questions))
JYTOPKYS3_data$surf <- rowMeans(surface_columns)
# select the columns related to learning strategies and create column 'stra' by averaging
strategic_columns <- select(JYTOPKYS3_data, one_of(strategic_questions))
JYTOPKYS3_data$stra <- rowMeans(strategic_columns)
# creating a set of desired columns
keep_columns <- c("gender", "age", "attitude", "deep", "stra", "surf", "points")
# creating a new dataset by choosing 'keep_columns' from the original dataset
# Tha data now has 166 individuals and 7 variables
analysis_dataset <- select(JYTOPKYS3_data, one_of(keep_columns))
colnames(analysis_dataset)
analysis_dataset <- filter(analysis_dataset, points != 0)
dim(analysis_dataset)
dim(JYTOPKYS3_data)
dim(JYTOPKYS3_data)
str(JYTOPKYS3_data)
summary(JYTOPKYS3_data)
dim(analysis_dataset)
str(analysis_dataset)
head(analysis_dataset)
View(analysis_dataset)
dim(analysis_dataset)
# Sampsa Huttunen, 26.1.2017, Wrangling Data from 'JYTOPKYS3_data' to 'analysis_dataset'
# Access the dplyr library
library(dplyr)
# reading data from a file
JYTOPKYS3_data <- read.table("http://www.helsinki.fi/~kvehkala/JYTmooc/JYTOPKYS3-data.txt", sep = "\t", header = TRUE)
# viewing JYTOPKYS3_data: a dataset containing information of 183 observations and 63 variables
View(JYTOPKYS3_data)
# inspecting JYTOPKYS3_data
dim(JYTOPKYS3_data)
# inspecting JYTOPKYS3_data
str(JYTOPKYS3_data)
# inspecting JYTOPKYS3_data
summary(JYTOPKYS3_data)
# Changing name of Age to age
colnames(JYTOPKYS3_data)[57] <- "age"
# Changing name of Attitude to attitude
colnames(JYTOPKYS3_data)[58] <- "attitude"
# Changing name of Points to points
colnames(JYTOPKYS3_data)[59] <- "points"
# print out the column names in data
colnames(JYTOPKYS3_data)
# choosing questions related to deep and surface learning, and learning strategies
deep_questions <- c("D03", "D11", "D19", "D27", "D07", "D14", "D22", "D30", "D06", "D15", "D23", "D31")
surface_questions <- c("SU02", "SU10", "SU18", "SU26", "SU05", "SU13", "SU21", "SU29", "SU08", "SU16", "SU24", "SU32")
strategic_questions <- c("ST01", "ST09", "ST17", "ST25", "ST04", "ST12", "ST20", "ST28")
# changing 'attitude' back to likert-scale (1-5)
JYTOPKYS3_data$attitude <- JYTOPKYS3_data$attitude/10
# select the columns related to deep learning and create column 'deep' by averaging
deep_columns <- select(JYTOPKYS3_data, one_of(deep_questions))
JYTOPKYS3_data$deep <- rowMeans(deep_columns)
# select the columns related to surface learning and create column 'surf' by averaging
surface_columns <- select(JYTOPKYS3_data, one_of(surface_questions))
JYTOPKYS3_data$surf <- rowMeans(surface_columns)
# select the columns related to learning strategies and create column 'stra' by averaging
strategic_columns <- select(JYTOPKYS3_data, one_of(strategic_questions))
JYTOPKYS3_data$stra <- rowMeans(strategic_columns)
# creating a set of desired columns
keep_columns <- c("gender", "age", "attitude", "deep", "stra", "surf", "points")
# creating a new dataset by choosing 'keep_columns' from the original dataset
analysis_dataset <- select(JYTOPKYS3_data, one_of(keep_columns))
# print out the column names in the new dataset ("gender", "age", "attitude", "deep", "stra", "surf", "points")
colnames(analysis_dataset)
# exclude observations where 'points' = 0
analysis_dataset <- filter(analysis_dataset, points != 0)
# checking the number of observations and variables in the new dataset
# Tha data now has 166 observations and 7 variables
dim(analysis_dataset)
# write the new dataset to a .csv file
write.csv(analysis_dataset, file = "data/analysis_dataset.csv")
# read the dataset back from the .csv file to 'analysis_dataset' (for practice)
analysis_dataset <- read.csv("data/analysis_dataset.csv")
# checking structure of the new dataset
str(analysis_dataset)
head(analysis_dataset)
# viewing the new dataset
View(analysis_dataset)
my_model <- lm(points ~ age + attitude + stra, data= learning2014)
my_model <- lm(points ~ age + attitude + stra, data= analysis_dataset)
summary(my_model)
my_model <- lm(points ~ attitude + stra, data= analysis_dataset)
summary(my_model)
my_model <- lm(points ~ age + attitude, data= analysis_dataset)
summary(my_model)
loss_func(class = alc$high_use, prob = 0)
# Logistic Regression
### Data Wrangling
##### I have created a new dataset 'alcohol-joined' from two datasets of alcohol use habits and background info of Math and Portugese language course students, n=382 (198 females and 184 males, mean age of 16.6 years).
##### Data Files:
* The original datasets are [student-mat.csv](https://github.com/huttusam/IODS-project/blob/master/data/student-mat.csv) and [student-por.csv](https://github.com/huttusam/IODS-project/blob/master/data/student-por.csv)
* The new dataset is [alcohol-joined.csv](https://github.com/huttusam/IODS-project/blob/master/data/alcohol-joined.csv)
##### Script:
* The R script used to create the new dataset (*with comments explaining the process*) is [create_alc.R](https://github.com/huttusam/IODS-project/blob/master/data/create_alc.R)
### Analysis
The new dataset 'alc' has 382 observations and 35 variables. The variables are:
```{r echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}
alc = read.table("data/alcohol-joined.csv", sep = ";", header = TRUE)
colnames(alc)
```
####The meaning of each variable is as follows:
* 1 school - student's school (binary: 'GP' - Gabriel Pereira or 'MS' - Mousinho da Silveira)
* 2 sex - student's sex (binary: 'F' - female or 'M' - male)
* 3 age - student's age (numeric: from 15 to 22)
* 4 address - student's home address type (binary: 'U' - urban or 'R' - rural)
* 5 famsize - family size (binary: 'LE3' - less or equal to 3 or 'GT3' - greater than 3)
* 6 Pstatus - parent's cohabitation status (binary: 'T' - living together or 'A' - apart)
* 7 Medu - mother's education (numeric: 0 - none, 1 - primary education (4th grade), 2 -  5th to 9th grade, 3 -  secondary education or 4 -  higher education)
* 8 Fedu - father's education (numeric: 0 - none, 1 - primary education (4th grade), 2 -  5th to 9th grade, 3 -  secondary education or 4 -  higher education)
* 9 Mjob - mother's job (nominal: 'teacher', 'health' care related, civil 'services' (e.g. administrative or police), 'at_home' or 'other')
* 10 Fjob - father's job (nominal: 'teacher', 'health' care related, civil 'services' (e.g. administrative or police), 'at_home' or 'other')
* 11 reason - reason to choose this school (nominal: close to 'home', school 'reputation', 'course' preference or 'other')
* 12 guardian - student's guardian (nominal: 'mother', 'father' or 'other')
* 13 traveltime - home to school travel time (numeric: 1 - <15 min., 2 - 15 to 30 min., 3 - 30 min. to 1 hour, or 4 - >1 hour)
* 14 studytime - weekly study time (numeric: 1 - <2 hours, 2 - 2 to 5 hours, 3 - 5 to 10 hours, or 4 - >10 hours)
* 15 failures - number of past class failures (numeric: n if 1<=n<3, else 4)
* 16 schoolsup - extra educational support (binary: yes or no)
* 17 famsup - family educational support (binary: yes or no)
* 18 paid - extra paid classes within the course subject (Math or Portuguese) (binary: yes or no)
* 19 activities - extra-curricular activities (binary: yes or no)
* 20 nursery - attended nursery school (binary: yes or no)
* 21 higher - wants to take higher education (binary: yes or no)
* 22 internet - Internet access at home (binary: yes or no)
* 23 romantic - with a romantic relationship (binary: yes or no)
* 24 famrel - quality of family relationships (numeric: from 1 - very bad to 5 - excellent)
* 25 freetime - free time after school (numeric: from 1 - very low to 5 - very high)
* 26 goout - going out with friends (numeric: from 1 - very low to 5 - very high)
* 27 Dalc - workday alcohol consumption (numeric: from 1 - very low to 5 - very high)
* 28 Walc - weekend alcohol consumption (numeric: from 1 - very low to 5 - very high)
* 29 health - current health status (numeric: from 1 - very bad to 5 - very good)
* 30 absences - number of school absences (numeric: from 0 to 93)
...and then there are the student's grades that are averages of her Mathematics and Portugese language grades:
* 31 G1 - first period grade (numeric: from 0 to 20)
* 32 G2 - second period grade (numeric: from 0 to 20)
* 33 G3 - final grade (numeric: from 0 to 20, output target)
...the new variables, I have created in the data wrangling are:
* 34 alc_use - the average of workday and weekend alcohol consumption (numeric: from 1 - very low to 5 - very high)
* 35 high_use - if alc_use is more than 2, then TRUE else FALSE (binary: TRUE or FALSE)
####Relationship of alcohol consumption to other variables
Let's look at a graphical summarization of the data:
```{r echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}
# access the tidyverse libraries tidyr, dplyr, ggplot2
library(tidyverse);
# draw a bar plot of each variable
gather(alc) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
```
Interegsting variables to look at, considering their relation to alcohol consumption, would be, for example, sex, health, absences from classes and final grades. My hypothesis would be that men use more alcohol than women and that high alcohol consumption correlates with lower grades, more abscence and lower health status.
OK, let's see how the aformentioned four variables correlate with alcohol consumption by cross tabulating them and drawing some plots to illustrate these correlations:
```{r echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}
# produce summary statistics by sex and mean alcohol use
alc %>% group_by(sex) %>% summarise(count = n(), mean_alcuse = mean(alc_use))
# initialise a plot of sex and alc_use
g1 <- ggplot(alc, aes(x = sex, y = alc_use))
# define the plot as a boxplot and draw it
g1 + geom_boxplot() + ylab("Alcohol Use") + ggtitle("Student alcohol consumption by sex")
# produce summary statistics by high_use and mean final grade
alc %>% group_by(high_use) %>% summarise(mean_grade = mean(G3))
# initialize a plot of high_use and G3
g2 <- ggplot(alc, aes(x = high_use, y = G3))
# define the plot as a boxplot and draw it
g2 + geom_boxplot() + ylab("grade") + ggtitle("Student final grades by alcohol consumption")
# produce summary statistics by high_use and mean absences
alc %>% group_by(high_use) %>% summarise(mean_abs = mean(absences))
# initialise a plot of high_use and absences
g3 <- ggplot(alc, aes(x = high_use, y = absences))
# define the plot as a boxplot and draw it
g3 + geom_boxplot() + ylab("Absences") + ggtitle("Student absences by alcohol consumption")
# produce summary statistics by high_use and health
alc %>% group_by(high_use) %>% summarise(mean_health = mean(health))
# initialise a plot of high_use and health
g4 <- ggplot(alc, aes(x = high_use, y = health))
# define the plot as a boxplot and draw it
g4 + geom_boxplot() + ylab("Health") + ggtitle("Student health by alcohol consumption")
```
By looking at the cross-tabulaions and graphical presentations above, we can see that male students report bigger alcohol consumption than their female peers. High alcohol use also seems to correlate slightly with lower final grades and more absences from classes. On the other hand, alcohol use does not seem to correlate with health, but we have to keep in mind that the participants of this study are very young (15-22 year olds, mean age 16.6 years) and health problems created by alcohol mostly accumulate over time.
###Logistical regression analysis
Next we fit a logistic regression model to explain high consumption of alcohol.
```{r echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}
# find the model with glm()
m <- glm(high_use ~ G3 + absences + health + sex, data = alc, family = "binomial")
```
The summary of our fitted model is
```{r echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}
# print out a summary of the model
summary(m)
```
... and the coefficients of the model as odds ratios with confidence intervals is
```{r echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}
# compute odds ratios (OR)
OR <- coef(m) %>% exp
# compute confidence intervals (CI)
CI = exp(confint(m))
# print out the odds ratios with their confidence intervals
cbind(OR, CI)
```
When we look at the above printout, we can see that final grades, amount of absences and gender can be used to predict the likelihood of high alcohol consumption reasonably well: lower grades, more absences, and being male increase the possibility of high alcohol use. On the other hand, health status doesn't seem to correlate with high alcohol use, which might be due to young age of participants.
###Predictive Power of the Model
Using the variables which, according to our logistic regression model, have a statistical relationship with alcohol consumption, let's perform a 2x2 cross tabulation of predictions versus the actual values and visualize both the actual values and predictions graphically.
```{r echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}
# find the model
m <- glm(high_use ~ G3 + absences + health + sex, data = alc, family = "binomial")
# predict the probability of high alcohol use
probabilities <- predict(m, type = "response")
# add the predicted probabilities to 'alc'
alc <- mutate(alc, probability = probabilities)
# use probabilities to predict high alcohol use
alc <- mutate(alc, prediction = probability > 0.5)
# tabulate target variable vs predictions
table(high_use = alc$high_use, prediction = alc$prediction)
# initialize a plot of high_use vs. probability
g <- ggplot(alc, aes(x = probability, y = high_use, col=prediction))
# define the geom as points and draw the plot
g + geom_point()
```
And let's compute the total proportion of inaccurately classified observations (i.e. incorrect predicitions, training error):
```{r echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}
# define a loss function (mean prediction error)
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
# call loss_func to compute the average number of wrong predictions in the (training) data
loss_func(class = alc$high_use, prob = 0)
```
... and, as a BONUS, do a 10-fold cross-validation:
```{r echo=FALSE, error=FALSE, warning=FALSE, message=FALSE}
# K-fold cross-validation
library(boot)
cv <- cv.glm(data = alc, cost = loss_func, glmfit = m, K = 10)
# average number of wrong predictions in the cross validation
cv$delta[1]
```
Our model estimates that 87 participants would not be and 12 would be high users when actually the opposite was true. The model accurately identified 27 participants as high users and 256 as not. Our graph tries to visualize the same, although the amount of accurately predicted non-high users (n=256) and inaccurately predicted high users (n=87) look quite similar (see red/left side of graph).
The training error of our model (0.26) is lower than way lower than if we were just to guess weather an individual has high or lowalcohol consumption a bit lower than our validation error (0.27) which means that our model has a good fit. about the same as in the model introduced in DataCamp (high_use ~ failures + absences + sex), which suggests that our model seems to work as well as the DataCamp model. better than the baseline model of including failures, absence and sex as explanatory variables. This is also the training error.
# find the model with glm()
m2 <- glm(high_use ~ freetime + absences + sex, data = alc, family = "binomial")
?cv
help(cv)
setwd("I:/Google Drive/Helsingin yliopisto/Intro to Open Data Science/IODS-project/data")
# Sampsa Huttunen, 8.2.2017, Wrangling Student Alcohol Consumption study dataset by Fabio Pagnotta & Hossain Mohammad Amran.
# Data source: https://archive.ics.uci.edu/ml/datasets/STUDENT+ALCOHOL+CONSUMPTION
#Set working directory
setwd("I:/Google Drive/Helsingin yliopisto/Intro to Open Data Science/IODS-project/data")
# Access dplyr
library(dplyr)
# Read data from math file to 'mat' and from Portugese file to 'por'
mat = read.table("student-mat.csv", sep = ";", header = TRUE)
por = read.table("student-por.csv", sep = ";", header = TRUE)
# Explore structure and dimensions of the new datasets
dim(mat)
dim(por)
colnames(mat)
colnames(por)
head(mat)
head(por)
str(mat)
str(por)
summary(mat)
summary(por)
glimpse(mat)
glimpse(por)
# mat has 395 observations and 33 variables
# por has 649 observations and 33 variables
# Determing common columns to use as identifiers
join_by <- c("school","sex","age","address","famsize","Pstatus","Medu","Fedu","Mjob","Fjob","reason","nursery","internet")
# Join datasets mat and por and add suffixes to variables
mat_por <- merge(mat, por, by = join_by, suffixes = c(".mat",".por"))
# Explore structure and dimensions of the new combined dataset 'mat_por'
dim(mat_por)
colnames(mat_por)
head(mat_por)
str(mat_por)
summary(mat_por)
glimpse(mat_por)
# Dataset mat_por has 382 observations and 53 variables
# create a new dataset 'alc' with only the joined columns from mat_por
alc <- select(mat_por, one_of(join_by))
dim(alc)
# Dataset alc now has 382 observations and 13 variables
colnames(mat)
# the columns in the original datasets which were not used for joining the data
notjoined_columns <- colnames(mat)[!colnames(mat) %in% join_by]
# Checking columns not used for joining
notjoined_columns
# for every column name not used for joining...
for(column_name in notjoined_columns) {
# select two columns from mat_por with the same original name
two_columns <- select(mat_por, starts_with(column_name))
# select the first column vector of those two columns
first_column <- select(two_columns, 1)[[1]]
# if that first column vector is numeric...
if(is.numeric(first_column)) {
# take a rounded average of each row of the two columns and
# add the resulting vector to the alc dataset
alc[column_name] <- round(rowMeans(two_columns))
} else { # else if it's not numeric...
# add the first column vector to the alc dataset
alc[column_name] <- first_column
}
}
dim(alc)
# Dataset alc now has 382 observations and 33 variables
# Check alc column names
colnames(alc)
# New column from averages of weekday and weekend alcohol use
alc <- mutate(alc, alc_use = (Dalc + Walc) / 2)
# New column where high_use = TRUE, if alc_use > 2, else FALSE
alc <- mutate(alc, high_use = alc_use > 2)
# Check dimensions of alc
dim(alc)
# alc now has 382 observations and 35 variables
# Check alc column names
colnames(alc)
# Taking a peek at alc... looks kosher
glimpse(alc)
# Save joined and modified data 'alc' to a file that looks good in an EUropean verion of Excel, but also has a decimal point instead of a comma
write.table(alc, file = "alcohol-joined.csv", sep = ";", qmethod="double", row.names=FALSE)
# Sampsa Huttunen, 10.2.2017, Wrangling Student Alcohol Consumption study dataset by Fabio Pagnotta & Hossain Mohammad Amran.
# Data source: https://archive.ics.uci.edu/ml/datasets/STUDENT+ALCOHOL+CONSUMPTION
#Set working directory
setwd("I:/Google Drive/Helsingin yliopisto/Intro to Open Data Science/IODS-project/data")
# Access dplyr
library(dplyr)
# Read data from math file to 'mat' and from Portugese file to 'por'
mat = read.table("student-mat.csv", sep = ";", header = TRUE)
por = read.table("student-por.csv", sep = ";", header = TRUE)
# Explore structure and dimensions of the new datasets
dim(mat)
dim(por)
colnames(mat)
colnames(por)
head(mat)
head(por)
str(mat)
str(por)
summary(mat)
summary(por)
glimpse(mat)
glimpse(por)
# mat has 395 observations and 33 variables
# por has 649 observations and 33 variables
# Determing common columns to use as identifiers
join_by <- c("school","sex","age","address","famsize","Pstatus","Medu","Fedu","Mjob","Fjob","reason","nursery","internet")
# Join datasets mat and por and add suffixes to variables
mat_por <- merge(mat, por, by = join_by, suffixes = c(".mat",".por"))
# Explore structure and dimensions of the new combined dataset 'mat_por'
dim(mat_por)
colnames(mat_por)
head(mat_por)
str(mat_por)
summary(mat_por)
glimpse(mat_por)
# Dataset mat_por has 382 observations and 53 variables
# create a new dataset 'alc' with only the joined columns from mat_por
alc <- select(mat_por, one_of(join_by))
dim(alc)
# Dataset alc now has 382 observations and 13 variables
colnames(mat)
# the columns in the original datasets which were not used for joining the data
notjoined_columns <- colnames(mat)[!colnames(mat) %in% join_by]
# Checking columns not used for joining
notjoined_columns
# for every column name not used for joining...
for(column_name in notjoined_columns) {
# select two columns from mat_por with the same original name
two_columns <- select(mat_por, starts_with(column_name))
# select the first column vector of those two columns
first_column <- select(two_columns, 1)[[1]]
# if that first column vector is numeric...
if(is.numeric(first_column)) {
# take a rounded average of each row of the two columns and
# add the resulting vector to the alc dataset
alc[column_name] <- round(rowMeans(two_columns))
} else { # else if it's not numeric...
# add the first column vector to the alc dataset
alc[column_name] <- first_column
}
}
dim(alc)
# Dataset alc now has 382 observations and 33 variables
# Check alc column names
colnames(alc)
# New column from averages of weekday and weekend alcohol use
alc <- mutate(alc, alc_use = (Dalc + Walc) / 2)
# New column where high_use = TRUE, if alc_use > 2, else FALSE
alc <- mutate(alc, high_use = alc_use > 2)
# Check dimensions of alc
dim(alc)
# alc now has 382 observations and 35 variables
# Check alc column names
colnames(alc)
# Taking a peek at alc... looks kosher
glimpse(alc)
# Save joined and modified data 'alc' to a file that looks good in an European version of Excel, but also has a decimal point instead of a comma
write.table(alc, file = "alcohol-joined.csv", sep = ";", qmethod="double", row.names=FALSE)
